theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 800), breaks = seq(0,800,20),
colors = c(brewer.pal(n = 8, name = "YlOrRd"),
brewer.pal(n = 9, name = "RdPu"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 100), breaks = seq(0,800,20),
colors = c(brewer.pal(n = 8, name = "YlOrRd"),
brewer.pal(n = 9, name = "RdPu"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 150), breaks = seq(0,800,20),
colors = c(brewer.pal(n = 8, name = "YlOrRd"),
brewer.pal(n = 9, name = "RdPu"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 350), breaks = seq(0,800,20),
colors = c(brewer.pal(n = 8, name = "YlOrRd"),
brewer.pal(n = 9, name = "RdPu"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 350), breaks = seq(0,350,20),
colors = c(brewer.pal(n = 8, name = "YlOrRd"),
brewer.pal(n = 9, name = "RdPu"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 400), breaks = seq(0,350,20),
colors = c(brewer.pal(n = 8, name = "YlOrRd"),
brewer.pal(n = 9, name = "RdPu"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 400), breaks = seq(0,400,20),
colors = c(brewer.pal(n = 8, name = "YlOrRd"),
brewer.pal(n = 9, name = "RdPu"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 400), breaks = seq(0,400,50),
colors = c(brewer.pal(n = 8, name = "YlOrRd"),
brewer.pal(n = 9, name = "RdPu"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 400), breaks = seq(0,400,50),
colors = c(brewer.pal(n = 5, name = "YlOrRd"),
brewer.pal(n = 9, name = "RdPu"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 400), breaks = seq(0,400,50),
colors = c(brewer.pal(n = 3, name = "YlOrRd"),
brewer.pal(n = 9, name = "RdPu"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 400), breaks = seq(0,400,50),
colors = c(brewer.pal(n = 3, name = "Spectral"),
brewer.pal(n = 9, name = "RdPu"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 400), breaks = seq(0,400,50),
colors = c(brewer.pal(n = 3, name = "Spectral"),
brewer.pal(n = 9, name = "Blues"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 400), breaks = seq(0,400,50),
colors = c(brewer.pal(n = 3, name = "Spectral"),
brewer.pal(n = 3, name = "PuOr"),
brewer.pal(n = 9, name = "Blues"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 400), breaks = seq(0,400,50),
colors = c(brewer.pal(n = 3, name = "Spectral"),
brewer.pal(n = 3, name = "Purples"),
brewer.pal(n = 9, name = "Blues"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 400), breaks = seq(0,400,50),
colors = c(brewer.pal(n = 3, name = "Spectral"),
brewer.pal(n = 9, name = "Blues"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.2,.3))
(pisco_p[[6*7]]) %>%
as.list() %>%
lapply(function(z){
res <- z %>% as.data.frame(xy = T) %>% .[complete.cases(.),]
colnames(res) <- c("x", "y", "val")
res$time <- z@data@names
return(res)
}) %>% do.call(rbind, .) %>%
ggplot() +
geom_tile(aes(x = x, y = y, fill = val)) +
theme_void() +
coord_quickmap() +
scale_fill_gradientn("mm/month",
limits = c(0, 400), breaks = seq(0,400,50),
colors = c(brewer.pal(n = 3, name = "Spectral"),
brewer.pal(n = 9, name = "Blues"))) +
geom_polygon(data = peru_shp %>% fortify(), aes(x = long, y = lat, group = group), colour = "black", fill = NA, size = 0.6)+
theme(legend.position = c(.1,.3))
library(blogdown)
serve_site()
setwd("/media/adrian/TOSHIBA EXT/500 GB Volume/desktop/JC/nonENSO_anomalyPP_.R")
setwd("/media/adrian/TOSHIBA EXT/500 GB Volume/desktop/JC/nonENSO_anomalyPP_.R")
setwd("/media/adrian/TOSHIBA EXT/500 GB Volume/desktop/JC")
library(raster)
library(xts)
library(dplyr)
library(rgdal)
library(ggplot2)
#########################
############ anomaly
shape_all <- readOGR("/home/buntu/Desktop/JC/subregiones_Peru_modbyAdr_merged3.shp", "subregiones_Peru_modbyAdr_merged3")
shape_pdf <- readOGR("/home/buntu/Desktop/JC/subregiones_Peru_modbyAdr_merged5.shp", "subregiones_Peru_modbyAdr_merged5")
#########################
############ anomaly
shape_all <- readOGR("/media/adrian/TOSHIBA EXT/500 GB Volume/desktop/JC/subregiones_Peru_modbyAdr_merged3.shp", "subregiones_Peru_modbyAdr_merged3")
shape_pdf <- readOGR("/media/adrian/TOSHIBA EXT/500 GB Volume/desktop/JC/subregiones_Peru_modbyAdr_merged5.shp", "subregiones_Peru_modbyAdr_merged5")
piscopm_anomaly <- brick("PISCOp_summer_anomaly_82_16.nc")
names(piscopm_anomaly) = paste("X", 1982:2016, sep = "")
piscopm_anomaly <- mask(piscopm_anomaly, shape_pdf)
non_enso_years = read.csv("EC_index_df.csv") %>% .[, c("time","event")]
ensop<- non_enso_years %>% mutate(event = ifelse(event == 1, 2, -2)) %>%
ggplot() +
geom_bar(aes(x = time,  y = event, fill = event < 1),
stat="identity", position = "identity")  +
scale_y_continuous(limits = c(-2,2)) +
scale_x_continuous(limits = c(1964,2017), breaks = c(1964:2017), expand = c(.01,.01)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, vjust = 1),
axis.text.y = element_text(angle = 90, vjust = 1))+ xlab("") + ylab("") + theme(legend.position="none")
piscopm_anomaly_number = lapply(as.list(1:35), function(z) unlist(as.data.frame(piscopm_anomaly[[z]]))) %>%
do.call(cbind, .)
colnames(piscopm_anomaly_number) = paste("X", 1982:2016, sep = "")
boxplot(piscopm_anomaly_number)
piscopm_anomaly_number_df <- reshape2::melt(piscopm_anomaly_number) %>%
.[complete.cases(.), ] %>% mutate(time = gsub('X','\\1',Var2)) %>%
.[,c("time", "value")]
piscopm_anomaly_number_median = apply(piscopm_anomaly_number, 2, median, na.rm = T) %>%
data.frame(time = 1982:2016, anomaly = . ) %>%
merge(., non_enso_years, by = "time") %>%
subset(., event != 1 & 0  > anomaly )
piscopm_anomaly_number_median_or = apply(piscopm_anomaly_number, 2, function(z) {
z = z[!is.na(z)]
z_all = length(z)
z_np = length(z[-0.8 > z])
condition = z_np*100/z_all
condition
}) %>%
data.frame(time = 1982:2016, anomaly = . ) %>%
merge(., non_enso_years, by = "time")
piscopm_anomaly_number_median <- piscopm_anomaly_number_median_or %>%
subset(., event != 1 &  anomaly > 15)
anomp <- merge(piscopm_anomaly_number_df, piscopm_anomaly_number_median_or, by = "time") %>%
ggplot() +
geom_boxplot(aes(x = time, y = value, fill = anomaly > 15), outlier.shape = "") +
scale_y_continuous(limits = c(-3,3)) +
scale_x_discrete(limits = c(1964:2017) %>% as.character()) +
theme_bw() + xlab("") + ylab("") + theme(legend.position="none") +
theme(axis.text.x = element_text(angle = 90, vjust = 1),
axis.text.y = element_text(angle = 90, vjust = 1))
spplot(piscopm_anomaly[[paste("X", piscopm_anomaly_number_median$time, sep = "")]])
shape_all <- readOGR("/home/buntu/Desktop/JC/subregiones_Peru_modbyAdr_merged3.shp", "subregiones_Peru_modbyAdr_merged3")
shape_all <- readOGR("/media/adrian/TOSHIBA EXT/500 GB Volume/desktop/JC/subregiones_Peru_modbyAdr_merged3.shp", "subregiones_Peru_modbyAdr_merged3")
piscopm_anomaly_df = lapply(as.list(piscopm_anomaly[[paste("X", piscopm_anomaly_number_median$time, sep = "")]]),
function(x) as.data.frame(x, xy = T) %>% .[complete.cases(.),])
names(piscopm_anomaly_df) = paste("X", piscopm_anomaly_number_median$time, sep = "")
piscopm_anomaly_df = data.table::rbindlist(piscopm_anomaly_df, idcol=T)
piscopm_anomaly_df$value = cut(piscopm_anomaly_df$X1985, breaks = c(-Inf, -2, -1, -0.1, 0.1, 1, 2,  Inf))
library(xts)
install.packages("xts")
setwd("/media/adrian/TOSHIBA EXT/500 GB Volume/desktop/JC")
library(raster)
library(xts)
library(dplyr)
library(rgdal)
library(ggplot2)
#########################
############ anomaly
shape_all <- readOGR("/media/adrian/TOSHIBA EXT/500 GB Volume/desktop/JC/subregiones_Peru_modbyAdr_merged3.shp", "subregiones_Peru_modbyAdr_merged3")
shape_pdf <- readOGR("/media/adrian/TOSHIBA EXT/500 GB Volume/desktop/JC/subregiones_Peru_modbyAdr_merged5.shp", "subregiones_Peru_modbyAdr_merged5")
piscopm_anomaly <- brick("PISCOp_summer_anomaly_82_16.nc")
names(piscopm_anomaly) = paste("X", 1982:2016, sep = "")
piscopm_anomaly <- mask(piscopm_anomaly, shape_pdf)
non_enso_years = read.csv("EC_index_df.csv") %>% .[, c("time","event")]
ensop<- non_enso_years %>% mutate(event = ifelse(event == 1, 2, -2)) %>%
ggplot() +
geom_bar(aes(x = time,  y = event, fill = event < 1),
stat="identity", position = "identity")  +
scale_y_continuous(limits = c(-2,2)) +
scale_x_continuous(limits = c(1964,2017), breaks = c(1964:2017), expand = c(.01,.01)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, vjust = 1),
axis.text.y = element_text(angle = 90, vjust = 1))+ xlab("") + ylab("") + theme(legend.position="none")
piscopm_anomaly_number = lapply(as.list(1:35), function(z) unlist(as.data.frame(piscopm_anomaly[[z]]))) %>%
do.call(cbind, .)
colnames(piscopm_anomaly_number) = paste("X", 1982:2016, sep = "")
boxplot(piscopm_anomaly_number)
piscopm_anomaly_number_df <- reshape2::melt(piscopm_anomaly_number) %>%
.[complete.cases(.), ] %>% mutate(time = gsub('X','\\1',Var2)) %>%
.[,c("time", "value")]
piscopm_anomaly_number_median = apply(piscopm_anomaly_number, 2, median, na.rm = T) %>%
data.frame(time = 1982:2016, anomaly = . ) %>%
merge(., non_enso_years, by = "time") %>%
subset(., event != 1 & 0  > anomaly )
piscopm_anomaly_number_median_or = apply(piscopm_anomaly_number, 2, function(z) {
z = z[!is.na(z)]
z_all = length(z)
z_np = length(z[-0.8 > z])
condition = z_np*100/z_all
condition
}) %>%
data.frame(time = 1982:2016, anomaly = . ) %>%
merge(., non_enso_years, by = "time")
piscopm_anomaly_number_median <- piscopm_anomaly_number_median_or %>%
subset(., event != 1 &  anomaly > 15)
anomp <- merge(piscopm_anomaly_number_df, piscopm_anomaly_number_median_or, by = "time") %>%
ggplot() +
geom_boxplot(aes(x = time, y = value, fill = anomaly > 15), outlier.shape = "") +
scale_y_continuous(limits = c(-3,3)) +
scale_x_discrete(limits = c(1964:2017) %>% as.character()) +
theme_bw() + xlab("") + ylab("") + theme(legend.position="none") +
theme(axis.text.x = element_text(angle = 90, vjust = 1),
axis.text.y = element_text(angle = 90, vjust = 1))
spplot(piscopm_anomaly[[paste("X", piscopm_anomaly_number_median$time, sep = "")]])
shape_all <- readOGR("/media/adrian/TOSHIBA EXT/500 GB Volume/desktop/JC/subregiones_Peru_modbyAdr_merged3.shp", "subregiones_Peru_modbyAdr_merged3")
piscopm_anomaly_df = lapply(as.list(piscopm_anomaly[[paste("X", piscopm_anomaly_number_median$time, sep = "")]]),
function(x) as.data.frame(x, xy = T) %>% .[complete.cases(.),])
names(piscopm_anomaly_df) = paste("X", piscopm_anomaly_number_median$time, sep = "")
piscopm_anomaly_df = data.table::rbindlist(piscopm_anomaly_df, idcol=T)
piscopm_anomaly_df = data.table::rbindlist(piscopm_anomaly_df, idcol=T)
install.packages("data.table")
names(piscopm_anomaly_df) = paste("X", piscopm_anomaly_number_median$time, sep = "")
piscopm_anomaly_df = data.table::rbindlist(piscopm_anomaly_df, idcol=T)
piscopm_anomaly_df$value = cut(piscopm_anomaly_df$X1985, breaks = c(-Inf, -2, -1, -0.1, 0.1, 1, 2,  Inf))
shape_all_df = fortify(shape_all)
shape_pdf_df = fortify(shape_pdf)
library(ggplot2)
colfunc <- colorRampPalette(c("red", "white", "blue"))
ggplot() +
geom_tile(data = piscopm_anomaly_df, aes(x = x, y = y, fill = value)) +
facet_wrap(~.id, ncol = 6) +
scale_fill_manual(values = colfunc(7)) +
geom_polygon(data = shape_all_df, aes(x = long, y = lat, group = group), size = 0.5, fill = NA, colour = "black") +
geom_polygon(data = shape_pdf_df, aes(x = long, y = lat, group = group), size = 0.1, fill = NA, colour = "black") +
theme_bw() +
coord_quickmap(xlim = c(-81.5, -68),ylim = c(-18.5, 0), expand = c(0,0)) +
xlab("") + ylab("")
piscopm_anomaly_df
ggplot() +
geom_tile(data = piscopm_anomaly_df %>% subset(.id == "X1990"), aes(x = x, y = y, fill = value)) +
facet_wrap(~.id, ncol = 6) +
scale_fill_manual(values = colfunc(7)) +
geom_polygon(data = shape_all_df, aes(x = long, y = lat, group = group), size = 0.5, fill = NA, colour = "black") +
geom_polygon(data = shape_pdf_df, aes(x = long, y = lat, group = group), size = 0.1, fill = NA, colour = "black") +
theme_bw() +
coord_quickmap(xlim = c(-81.5, -68),ylim = c(-18.5, 0), expand = c(0,0)) +
xlab("") + ylab("")
ggplot() +
geom_tile(data = piscopm_anomaly_df %>% subset(.id == "X1990"), aes(x = x, y = y, fill = value)) +
facet_wrap(~.id, ncol = 6) +
scale_fill_manual(values = colfunc(7)) +
geom_polygon(data = shape_all_df, aes(x = long, y = lat, group = group), size = 0.5, fill = NA, colour = "black") +
geom_polygon(data = shape_pdf_df, aes(x = long, y = lat, group = group), size = 0.1, fill = NA, colour = "black") +
theme_void() +
coord_quickmap(xlim = c(-81.5, -68),ylim = c(-18.5, 0), expand = c(0,0)) +
xlab("") + ylab("")
ggplot() +
geom_tile(data = piscopm_anomaly_df %>% subset(.id == "X1990"), aes(x = x, y = y, fill = value)) +
# facet_wrap(~.id, ncol = 6) +
scale_fill_manual(values = colfunc(7)) +
geom_polygon(data = shape_all_df, aes(x = long, y = lat, group = group), size = 0.5, fill = NA, colour = "black") +
geom_polygon(data = shape_pdf_df, aes(x = long, y = lat, group = group), size = 0.1, fill = NA, colour = "black") +
theme_void() +
coord_quickmap(xlim = c(-81.5, -68),ylim = c(-18.5, 0), expand = c(0,0)) +
xlab("") + ylab("")
ggplot() +
geom_tile(data = piscopm_anomaly_df %>% subset(.id == "X1990"), aes(x = x, y = y, fill = value)) +
# facet_wrap(~.id, ncol = 6) +
scale_fill_manual("anom_P",values = colfunc(7),drop = FALSE) +
geom_polygon(data = shape_all_df, aes(x = long, y = lat, group = group), size = 0.5, fill = NA, colour = "black") +
geom_polygon(data = shape_pdf_df, aes(x = long, y = lat, group = group), size = 0.1, fill = NA, colour = "black") +
theme_void() +
coord_quickmap(xlim = c(-81.5, -68),ylim = c(-18.5, 0), expand = c(0,0)) +
xlab("") + ylab("")
shape_pdf <- readOGR("/home/buntu/Desktop/JC/subregiones_Peru_modbyAdr_merged5.shp", "subregiones_Peru_modbyAdr_merged5")
ggplot() +
geom_tile(data = piscopm_anomaly_df %>% subset(.id == "X1990"), aes(x = x, y = y, fill = value)) +
# facet_wrap(~.id, ncol = 6) +
scale_fill_manual("anom_P",values = colfunc(7),drop = FALSE) +
geom_polygon(data = shape_all_df, aes(x = long, y = lat, group = group), size = 0.5, fill = NA, colour = "black") +
geom_polygon(data = shape_pdf_df, aes(x = long, y = lat, group = group), size = 0.1, fill = NA, colour = "black") +
theme_void() +
coord_quickmap(xlim = c(-81.5, -68),ylim = c(-18.5, 0), expand = c(0,0)) +
xlab("") + ylab("") +
theme(legend.position = c(.2,.3))
ggplot() +
geom_tile(data = piscopm_anomaly_df %>% subset(.id == "X1990"), aes(x = x, y = y, fill = value)) +
# facet_wrap(~.id, ncol = 6) +
scale_fill_manual("anom_P",values = colfunc(7),drop = FALSE) +
geom_polygon(data = shape_all_df, aes(x = long, y = lat, group = group), size = 0.5, fill = NA, colour = "black") +
geom_polygon(data = shape_pdf_df, aes(x = long, y = lat, group = group), size = 0.1, fill = NA, colour = "black") +
theme_void() +
coord_quickmap(xlim = c(-81.5, -68),ylim = c(-18.5, 0), expand = c(0,0)) +
xlab("") + ylab("") +
theme(legend.position = c(.1,.3))
library(blogdown)
serve_site()
serve_site()
library(blogdown)
serve_site()
library(blogdown)
serve_site()
serve_site()
serve_site()
serve_site()
serve_site()
library(blogdown)
serve_site()
library(blogdown)
serve_site()
